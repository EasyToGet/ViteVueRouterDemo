import{_ as I,r as v,o as r,c as i,d as e,F as V,f as y,g as m,t as c,a as d,w as S,b as x,e as C,v as E,h as b,i as P}from"./index-9dba1167.js";const{VITE_APP_URL:_,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"edvuelive2023",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},A={data(){return{loadingStatus:{loadingItem:""},form:{user:{name:"",email:"",tel:"",address:""},message:""},cart:{}}},components:{},methods:{getCart(){const o=`${_}/v2/api/${h}/cart`;this.$http.get(o).then(t=>{t.data.success?this.cart=t.data.data:alert(t.data.message)})},updateCart(o){this.loadingStatus.loadingItem=o.id;const t=`${_}/v2/api/${h}/cart/${o.id}`,n={product_id:o.product.id,qty:o.qty};this.$http.put(t,{data:n}).then(p=>{alert(p.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(p=>{alert(p.response.data.message)})},deleteAllCarts(){const o=`${_}/v2/api/${h}/carts`;this.$http.delete(o).then(t=>{alert(t.data.message),this.getCart()}).catch(t=>{alert(t.response.data.message)})},removeCartItem(o){this.loadingStatus.loadingItem=o.id;const t=`${_}/v2/api/${h}/cart/${o.id}`;this.$http.delete(t).then(n=>{alert(n.data.message),this.getCart()}).catch(n=>{alert(n.response.data.message)}),this.loadingStatus.loadingItem=""},createOrder(){const o=`${_}/v2/api/${h}/order`,t=this.form;this.$http.post(o,{data:t}).then(n=>{alert(n.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart()}).catch(n=>{alert(n.response.data.message)})}},mounted(){this.getCart()}},U=e("h1",null,"這是購物車列表頁面",-1),q={class:"text-end"},T={class:"table align-middle"},w=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),F=["onClick","disabled"],D={key:0,class:"fas fa-spinner fa-pulse"},M={key:0,class:"text-success"},B={class:"input-group input-group-sm"},L={class:"input-group mb-3"},N=["onUpdate:modelValue","onChange","disabled"],O=["value"],R={class:"input-group-text",id:"basic-addon2"},H={class:"text-end"},j={key:0,class:"text-success"},z=e("td",{colspan:"3",class:"text-end"},"總計",-1),G={class:"text-end"},J={key:0},K=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),Q={class:"text-end text-success"},W={class:"my-5 row justify-content-center"},X={class:"mb-3"},Y=e("label",{for:"email",class:"form-label"},"Email",-1),Z={class:"mb-3"},$=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ee={class:"mb-3"},te=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),se={class:"mb-3"},le=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ae={class:"mb-3"},oe=e("label",{for:"message",class:"form-label"},"留言",-1),ne=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function de(o,t,n,p,s,u){const f=v("VField"),g=v("ErrorMessage"),k=v("VForm");return r(),i(V,null,[U,e("div",null,[e("div",q,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...l)=>u.deleteAllCarts&&u.deleteAllCarts(...l))},"清空購物車")]),e("table",T,[w,e("tbody",null,[s.cart.carts?(r(!0),i(V,{key:0},y(s.cart.carts,l=>(r(),i("tr",{key:l.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:a=>u.removeCartItem(l),disabled:s.loadingStatus.loadingItem===l.id},[s.loadingStatus.loadingItem===l.id?(r(),i("i",D)):m("",!0),x(" x ")],8,F)]),e("td",null,[x(c(l.product.title)+" ",1),l.coupon?(r(),i("div",M," 已套用優惠券 ")):m("",!0)]),e("td",null,[e("div",B,[e("div",L,[C(e("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":a=>l.qty=a,onChange:a=>u.updateCart(l),disabled:s.loadingStatus.loadingItem===l.id},[(r(),i(V,null,y(30,a=>e("option",{value:a,key:a+"123"},c(a),9,O)),64))],40,N),[[E,l.qty,void 0,{number:!0}]]),e("span",R,c(l.product.unit),1)])])]),e("td",H,[s.cart.final_total!==s.cart.total?(r(),i("small",j,"折扣價：")):m("",!0),x(" "+c(l.final_total),1)])]))),128)):m("",!0)]),e("tfoot",null,[e("tr",null,[z,e("td",G,c(s.cart.total),1)]),s.cart.final_total!==s.cart.total?(r(),i("tr",J,[K,e("td",Q,c(s.cart.final_total),1)])):m("",!0)])])]),e("div",W,[d(k,{ref:"form",class:"col-md-6",onSubmit:u.createOrder},{default:S(({errors:l})=>[e("div",X,[Y,d(f,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=a=>s.form.user.email=a)},null,8,["class","modelValue"]),d(g,{name:"email",class:"invalid-feedback"})]),e("div",Z,[$,d(f,{id:"name",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=a=>s.form.user.name=a)},null,8,["class","modelValue"]),d(g,{name:"姓名",class:"invalid-feedback"})]),e("div",ee,[te,d(f,{id:"tel",name:"電話",type:"text",class:b(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=a=>s.form.user.tel=a)},null,8,["class","modelValue"]),d(g,{name:"電話",class:"invalid-feedback"})]),e("div",se,[le,d(f,{id:"address",name:"地址",type:"text",class:b(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=a=>s.form.user.address=a)},null,8,["class","modelValue"]),d(g,{name:"地址",class:"invalid-feedback"})]),e("div",ae,[oe,C(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=a=>s.form.message=a)},`\r
        `,512),[[P,s.form.message]])]),ne]),_:1},8,["onSubmit"])])],64)}const ie=I(A,[["render",de]]);export{ie as default};
